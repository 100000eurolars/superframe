<script src="https://aframe.io/releases/0.8.2/aframe.min.js"></script>

<style>
  #form {
    background: #444;
    color: #FAFAFA;
    left: 0;
    padding: 20px;
    position: fixed;
    top: 0;
    z-index: 99999;
  }

  #info {
    background: #444;
    color: #FAFAFA;
    left: 0;
    padding: 20px;
    position: fixed;
    bottom: 0;
    z-index: 99999;
  }
</style>

<a-scene embedded="true">
  <a-sky color="#FAFAFA"></a-sky>

  <a-camera position="0 0.75 4"></a-camera>
  <a-light type="ambient" color="#666"></a-light>
  <a-light position="-1 0 -1"></a-light>
  <a-light position="1 0 -0.5" intensity="0.65"></a-light>
  <a-light position="0.25 0 1" intensity="0.25"></a-light>

  <a-entity class="wrapper">
    <a-entity class="thing">
      <a-box class="shape" color="green"></a-box>
    </a-entity>
  </a-entity>
</a-scene>

<div id="form"></div>
<div id="info"></div>

<script>
  window.thing = document.querySelector('.thing');
  window.shape = document.querySelector('.shape');

  var form = document.getElementById('form');
  var info = document.getElementById('info');
  var targets = ['.wrapper', '.thing', '.shape'];
  for (var i = 0; i < targets.length; i++) {
    var rInfo = document.createElement('span');
    rInfo.innerHTML = '0 0 0';
    var sInfo = document.createElement('span');
    sInfo.innerHTML = '1 1 1';

    var rWorldInfo = document.createElement('p');
    rWorldInfo.innerHTML = `${targets[i]} World Rotation: 0 0 0 `;
    var sWorldInfo = document.createElement('p');
    sWorldInfo.innerHTML = `${targets[i]} World Scale: 1 1 1`;
    info.appendChild(rWorldInfo);
    info.appendChild(sWorldInfo);

    var targetEl = document.querySelector(targets[i]);
    form.addEventListener('input', worldRotationListener(targetEl, rWorldInfo));
    form.addEventListener('input', worldScaleListener(targetEl, sWorldInfo));

    var rLabel = document.createElement('label');
    rLabel.innerHTML = `${targets[i]} Rotation`;
    var rInput = document.createElement('input');
    rInput.setAttribute('type', 'range');
    rInput.setAttribute('min', -360);
    rInput.setAttribute('max', 360);
    rInput.setAttribute('step', 45);
    rInput.setAttribute('value', 0);
    rInput.addEventListener('input', rotationListener(targetEl, rInput, rInfo, rWorldInfo));
    form.appendChild(rLabel);
    form.appendChild(rInput);
    form.appendChild(rInfo);
    form.appendChild(document.createElement('br'));

    var sLabel = document.createElement('label');
    sLabel.innerHTML = `${targets[i]} Scale`;
    var sInput = document.createElement('input');
    sInput.setAttribute('type', 'range');
    sInput.setAttribute('min', 0.5);
    sInput.setAttribute('max', 3);
    sInput.setAttribute('value', 1);
    sInput.setAttribute('step', 0.1);
    sInput.setAttribute('value', 1);
    sInput.addEventListener('input', scaleListener(targetEl, sInput, sInfo, sWorldInfo));
    form.appendChild(sLabel);
    form.appendChild(sInput);
    form.appendChild(sInfo);
    form.appendChild(document.createElement('br'));
  }

  function rotationListener (targetEl, rInput, rInfo, rWorldInfo) {
    return function () {
      var val = parseFloat(rInput.value);
      targetEl.object3D.rotation.y = THREE.Math.degToRad(val);
      rInfo.innerHTML = `0 ${val} 0`;
      var eul = new THREE.Euler();
      targetEl.object3D.getWorldRotation(eul);
      rWorldInfo.innerHTML = `${targetEl.getAttribute('class')} World Rotation:  ${THREE.Math.radToDeg(eul.x)} ${THREE.Math.radToDeg(eul.y)} ${THREE.Math.radToDeg(eul.z)}`;
    };
  }

  function worldRotationListener (targetEl, rWorldInfo) {
    return function () {
      var eul = new THREE.Euler();
      targetEl.object3D.getWorldRotation(eul);
      rWorldInfo.innerHTML = `${targetEl.getAttribute('class')} World Rotation:  ${THREE.Math.radToDeg(eul.x.toFixed(1))} ${THREE.Math.radToDeg(eul.y.toFixed(1))} ${THREE.Math.radToDeg(eul.z.toFixed(1))}`;
    };
  }

  function scaleListener (targetEl, sInput, sInfo, sWorldInfo) {
    return function () {
      var val = parseFloat(sInput.value);
      targetEl.object3D.scale.x = val;
      sInfo.innerHTML = `${val} 1 1`;
    };
  }

  function worldScaleListener (targetEl, sWorldInfo) {
    return function () {
      var vec = new THREE.Vector3();
      targetEl.object3D.getWorldScale(vec);
      sWorldInfo.innerHTML = `${targetEl.getAttribute('class')} World Scale:  ${vec.x.toFixed(1)} ${vec.y.toFixed(1)} ${vec.z.toFixed(1)}`;
    };
  }
</script>
